<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SAMD Admin Panel</title>
    <link rel="icon" type="image/svg+xml"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>‚öôÔ∏è</text></svg>">
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Outfit:wght@400;500;600;700;800&display=swap"
        rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>
    <!-- Leaflet -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <link rel="stylesheet" href="css/admin.css">
</head>

<body>
    <!-- Login Section -->
    <div class="admin-login" id="loginSection">
        <div class="login-container">
            <div class="login-header">
                <div class="login-icon">üîê</div>
                <h1 class="login-title">Admin Access</h1>
                <p class="login-subtitle">SAMD Directory Administration Panel</p>
            </div>

            <!-- Phone Step -->
            <div id="phoneStep">
                <div class="form-group">
                    <label class="form-label">Admin Phone Number</label>
                    <div style="display: flex; gap: 8px;">
                        <input type="text" class="form-input" value="+91" readonly
                            style="width: 70px; text-align: center;">
                        <input type="tel" class="form-input" id="adminPhoneInput" placeholder="Enter admin phone"
                            maxlength="10" style="flex: 1;">
                    </div>
                </div>
                <button class="btn btn-primary" style="width: 100%; margin-top: 20px;" onclick="adminAuth.sendOTP()">
                    <i data-lucide="send" style="width: 18px; height: 18px;"></i>
                    Send OTP
                </button>
                <p style="text-align: center; margin-top: 20px; color: var(--admin-text-muted); font-size: 13px;">
                    Only authorized administrators can access this panel
                </p>
            </div>

            <!-- OTP Step -->
            <div id="otpStep" style="display: none;">
                <div class="form-group">
                    <label class="form-label">Enter 6-digit OTP</label>
                    <div style="display: flex; gap: 8px; justify-content: center;">
                        <input type="text" class="form-input otp-digit" maxlength="1"
                            style="width: 50px; text-align: center; font-size: 24px; font-weight: 700;">
                        <input type="text" class="form-input otp-digit" maxlength="1"
                            style="width: 50px; text-align: center; font-size: 24px; font-weight: 700;">
                        <input type="text" class="form-input otp-digit" maxlength="1"
                            style="width: 50px; text-align: center; font-size: 24px; font-weight: 700;">
                        <input type="text" class="form-input otp-digit" maxlength="1"
                            style="width: 50px; text-align: center; font-size: 24px; font-weight: 700;">
                        <input type="text" class="form-input otp-digit" maxlength="1"
                            style="width: 50px; text-align: center; font-size: 24px; font-weight: 700;">
                        <input type="text" class="form-input otp-digit" maxlength="1"
                            style="width: 50px; text-align: center; font-size: 24px; font-weight: 700;">
                    </div>
                </div>
                <button class="btn btn-primary" style="width: 100%; margin-top: 20px;" onclick="adminAuth.verifyOTP()">
                    <i data-lucide="check-circle" style="width: 18px; height: 18px;"></i>
                    Verify & Login
                </button>
                <button class="btn btn-secondary" style="width: 100%; margin-top: 12px;"
                    onclick="adminAuth.backToPhone()">
                    Change Phone Number
                </button>
            </div>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div class="admin-layout" id="adminDashboard" style="display: none;">
        <!-- Sidebar -->
        <aside class="admin-sidebar">
            <div class="admin-logo">
                <div class="admin-logo-icon">üè•</div>
                <div class="admin-logo-text">
                    <h1>SAMD Admin</h1>
                    <span>Control Panel</span>
                </div>
            </div>

            <nav class="admin-nav">
                <a href="index.html" class="nav-item"
                    style="background: var(--admin-bg-hover); margin-bottom: 12px; border-radius: 8px; text-decoration: none;">
                    <i data-lucide="arrow-left"></i>
                    <span>Back to Directory</span>
                </a>
                <button class="nav-item active" data-section="dashboard">
                    <i data-lucide="layout-dashboard"></i>
                    <span>Dashboard</span>
                </button>
                <button class="nav-item" data-section="doctors">
                    <i data-lucide="users"></i>
                    <span>Doctors</span>
                </button>
                <button class="nav-item" data-section="user-management">
                    <i data-lucide="user-cog"></i>
                    <span>User Management</span>
                </button>
                <button class="nav-item" data-section="notifications">
                    <i data-lucide="bell"></i>
                    <span>Notifications</span>
                </button>
                <button class="nav-item" data-section="settings">
                    <i data-lucide="settings"></i>
                    <span>Settings</span>
                </button>
            </nav>

            <div class="admin-user">
                <div class="admin-user-info">
                    <div class="admin-avatar">SK</div>
                    <div>
                        <div class="admin-name">Dr. Shahnavaz Kanuga</div>
                        <div class="admin-role">Super Admin</div>
                    </div>
                </div>
                <button class="btn btn-secondary btn-sm" style="width: 100%;" onclick="adminAuth.logout()">
                    <i data-lucide="log-out" style="width: 16px; height: 16px;"></i>
                    <span>Logout</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="admin-main">
            <!-- Dashboard Section -->
            <section id="section-dashboard">
                <div class="admin-header">
                    <div>
                        <h1 class="admin-page-title">Dashboard</h1>
                        <p class="admin-page-subtitle">Welcome back, Dr. Shahnavaz Kanuga</p>
                    </div>
                    <a href="index.html" class="btn btn-secondary">
                        <i data-lucide="external-link" style="width: 18px; height: 18px;"></i>
                        View Directory
                    </a>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-card-header">
                            <div class="stat-icon primary">
                                <i data-lucide="users" style="width: 24px; height: 24px;"></i>
                            </div>
                        </div>
                        <div class="stat-value" id="stat-total">0</div>
                        <div class="stat-label">Total Doctors</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-card-header">
                            <div class="stat-icon success">
                                <i data-lucide="badge-check" style="width: 24px; height: 24px;"></i>
                            </div>
                        </div>
                        <div class="stat-value" id="stat-verified">0</div>
                        <div class="stat-label">Verified</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-card-header">
                            <div class="stat-icon secondary">
                                <i data-lucide="star" style="width: 24px; height: 24px;"></i>
                            </div>
                        </div>
                        <div class="stat-value" id="stat-featured">0</div>
                        <div class="stat-label">Featured</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-card-header">
                            <div class="stat-icon warning">
                                <i data-lucide="tag" style="width: 24px; height: 24px;"></i>
                            </div>
                        </div>
                        <div class="stat-value" id="stat-specialties">0</div>
                        <div class="stat-label">Specialties</div>
                    </div>
                </div>

                <div class="data-table-container">
                    <div class="table-header">
                        <h2 class="table-title">Recent Doctors</h2>
                        <button class="btn btn-primary btn-sm" onclick="adminPanel.showAddDoctor()">
                            <i data-lucide="plus" style="width: 16px; height: 16px;"></i>
                            Add Doctor
                        </button>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Doctor</th>
                                <th>Specialty</th>
                                <th>Status</th>
                                <th>Tier</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="recentDoctorsTable">
                            <!-- Dynamic content -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Notifications Section -->
            <section id="section-notifications" style="display: none;">
                <div class="admin-header">
                    <div>
                        <h1 class="admin-page-title">Notifications</h1>
                        <p class="admin-page-subtitle">Review flagged data issues</p>
                    </div>
                </div>
                <div class="data-table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Doctor</th>
                                <th>Phone</th>
                                <th>Issue</th>
                                <th>City/District</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="issuesTableBody">
                            <!-- Populated by JS -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Doctors Section -->
            <section id="section-doctors" style="display: none;">
                <div class="admin-header">
                    <div>
                        <h1 class="admin-page-title">Manage Doctors</h1>
                        <p class="admin-page-subtitle">Add, edit, and manage all doctors in the directory</p>
                    </div>
                    <button class="btn btn-primary" onclick="adminPanel.showAddDoctor()">
                        <i data-lucide="plus" style="width: 18px; height: 18px;"></i>
                        Add Doctor
                    </button>
                </div>

                <div class="data-table-container">
                    <div class="table-header">
                        <h2 class="table-title">All Doctors (<span id="doctorTableCount">0</span>)</h2>
                        <div class="table-search">
                            <input type="text" class="search-input" id="doctorSearchInput"
                                placeholder="Search doctors...">
                        </div>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Doctor</th>
                                <th>Phone</th>
                                <th>Specialty</th>
                                <th>Geo-Tagged</th>
                                <th>Status</th>
                                <th>Tier</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="allDoctorsTable">
                            <!-- Dynamic content -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- User Management Section -->
            <section id="section-user-management" style="display: none;">
                <div class="admin-header">
                    <div>
                        <h1 class="admin-page-title">User Management</h1>
                        <p class="admin-page-subtitle">Manage all registered users, roles, and doctor profiles</p>
                    </div>
                    <div style="display: flex; gap: 12px;">
                        <button class="btn btn-secondary" onclick="adminPanel.showAddDoctor()">
                            <i data-lucide="user-plus" style="width: 18px; height: 18px;"></i>
                            Add Doctor
                        </button>
                        <button class="btn btn-primary" onclick="adminPanel.editAdminProfile()">
                            <i data-lucide="user-circle" style="width: 18px; height: 18px;"></i>
                            Edit My Profile
                        </button>
                    </div>
                </div>

                <!-- Search and Filters -->
                <div class="data-table-container" style="margin-bottom: 20px;">
                    <div class="table-header"
                        style="background: var(--admin-bg); padding: 20px; border-radius: 12px; box-shadow: var(--admin-shadow);">
                        <div style="display: flex; gap: 12px; align-items: center; flex-wrap: wrap; width: 100%;">
                            <div class="table-search" style="flex: 1; min-width: 300px;">
                                <i data-lucide="search"
                                    style="position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: var(--admin-text-muted); width: 18px; height: 18px;"></i>
                                <input type="text" class="search-input" id="userSearchInput"
                                    placeholder="Search by name, phone, hospital, specialty..."
                                    style="padding-left: 40px; font-size: 15px;">
                            </div>
                            <select class="form-select" id="userRoleFilter" style="width: 150px;">
                                <option value="all">All Roles</option>
                                <option value="user">User Only</option>
                                <option value="doctor">Doctor</option>
                                <option value="admin">Admin</option>
                            </select>
                            <select class="form-select" id="userProfileFilter" style="width: 180px;">
                                <option value="all">All Users</option>
                                <option value="has_profile">Has Doctor Profile</option>
                                <option value="no_profile">No Doctor Profile</option>
                            </select>
                            <span class="badge"
                                style="padding: 8px 16px; font-size: 14px; background: var(--admin-primary); color: white;">
                                <span id="userTableCount">0</span> users
                            </span>
                        </div>
                    </div>
                </div>

                <!-- Users Table -->
                <div class="data-table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th style="width: 60px;">ID</th>
                                <th style="width: 200px;">Name</th>
                                <th style="width: 130px;">Phone</th>
                                <th style="width: 100px;">Role</th>
                                <th style="width: 200px;">Hospital</th>
                                <th style="width: 150px;">Specialty</th>
                                <th style="width: 120px;">Doctor Profile</th>
                                <th style="width: 150px;">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="allUsersTable">
                            <!-- Dynamic content -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Settings Section -->
            <section id="section-settings" style="display: none;">
                <div class="admin-header">
                    <div>
                        <h1 class="admin-page-title">Settings</h1>
                        <p class="admin-page-subtitle">Configure directory settings and preferences</p>
                    </div>
                    <button class="btn btn-primary" onclick="adminPanel.saveSettings()">
                        <i data-lucide="save" style="width: 18px; height: 18px;"></i>
                        Save Changes
                    </button>
                </div>

                <div class="settings-card">
                    <div class="settings-card-header">
                        <div>
                            <h3 class="settings-card-title">Creator Footer</h3>
                            <p class="settings-desc">Show "Created by Dr. Shahnavaz Kanuga" footer on all pages</p>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="setting-creatorFooter" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="form-group" style="margin-top: 16px;">
                        <label class="form-label">Creator Name</label>
                        <input type="text" class="form-input" id="setting-creatorName" value="Dr. Shahnavaz Kanuga">
                    </div>
                    <div class="form-group" style="margin-top: 12px;">
                        <label class="form-label">Creator Phone (for contact link)</label>
                        <input type="text" class="form-input" id="setting-creatorPhone" value="9879520091">
                    </div>
                </div>

                <div class="settings-card">
                    <div class="settings-card-header">
                        <div>
                            <h3 class="settings-card-title">Show Advertisements</h3>
                            <p class="settings-desc">Display ad zones on the directory</p>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="setting-showAds" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>

                <div class="settings-card">
                    <div class="settings-card-header">
                        <div>
                            <h3 class="settings-card-title">Default Map View</h3>
                            <p class="settings-desc">Configure default map center and zoom level</p>
                        </div>
                    </div>
                    <div class="form-grid" style="margin-top: 16px;">
                        <div class="form-group">
                            <label class="form-label">Default Latitude</label>
                            <input type="number" step="any" class="form-input" id="setting-defaultLat" value="21.1702">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Default Longitude</label>
                            <input type="number" step="any" class="form-input" id="setting-defaultLng" value="72.8311">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Default Zoom Level</label>
                            <input type="number" class="form-input" id="setting-defaultZoom" value="12" min="1"
                                max="18">
                        </div>
                    </div>
                </div>

                <div class="settings-card">
                    <h3 class="settings-card-title">Data Management</h3>
                    <div style="display: flex; gap: 12px; margin-top: 16px;">
                        <button class="btn btn-secondary" onclick="adminPanel.exportData()">
                            <i data-lucide="download" style="width: 18px; height: 18px;"></i>
                            Export Data (JSON)
                        </button>
                        <button class="btn btn-secondary" onclick="document.getElementById('importFile').click()">
                            <i data-lucide="upload" style="width: 18px; height: 18px;"></i>
                            Import Data
                        </button>
                        <input type="file" id="importFile" accept=".json" style="display: none;"
                            onchange="adminPanel.importData(event)">
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Edit Doctor Modal -->
    <div class="modal-overlay" id="doctorModal">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">Add Doctor</h2>
                <button class="modal-close" onclick="adminPanel.closeModal()">
                    <i data-lucide="x" style="width: 20px; height: 20px;"></i>
                </button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="editDoctorId">
                <div class="form-grid">
                    <div class="form-group full-width">
                        <label class="form-label">Full Name *</label>
                        <input type="text" class="form-input" id="doctorName" placeholder="Dr. Full Name">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Phone *</label>
                        <input type="tel" class="form-input" id="doctorPhone" placeholder="9876543210" maxlength="10">
                    </div>
                    <div class="form-group">
                        <label class="form-label">District *</label>
                        <select class="form-select" id="doctorDistrict">
                            <option value="">Select District</option>
                            <option value="Ahmedabad">Ahmedabad</option>
                            <option value="Amreli">Amreli</option>
                            <option value="Anand">Anand</option>
                            <option value="Aravalli">Aravalli</option>
                            <option value="Banaskantha">Banaskantha</option>
                            <option value="Bharuch">Bharuch</option>
                            <option value="Bhavnagar">Bhavnagar</option>
                            <option value="Botad">Botad</option>
                            <option value="Chhota Udaipur">Chhota Udaipur</option>
                            <option value="Dahod">Dahod</option>
                            <option value="Dang">Dang</option>
                            <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                            <option value="Gandhinagar">Gandhinagar</option>
                            <option value="Gir Somnath">Gir Somnath</option>
                            <option value="Jamnagar">Jamnagar</option>
                            <option value="Junagadh">Junagadh</option>
                            <option value="Kachchh">Kachchh</option>
                            <option value="Kheda">Kheda</option>
                            <option value="Mahisagar">Mahisagar</option>
                            <option value="Mehsana">Mehsana</option>
                            <option value="Morbi">Morbi</option>
                            <option value="Narmada">Narmada</option>
                            <option value="Navsari">Navsari</option>
                            <option value="Panchmahal">Panchmahal</option>
                            <option value="Patan">Patan</option>
                            <option value="Porbandar">Porbandar</option>
                            <option value="Rajkot">Rajkot</option>
                            <option value="Sabarkantha">Sabarkantha</option>
                            <option value="Surat">Surat</option>
                            <option value="Surendranagar">Surendranagar</option>
                            <option value="Tapi">Tapi</option>
                            <option value="Vadodara">Vadodara</option>
                            <option value="Valsad">Valsad</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Specialty *</label>
                        <select class="form-select" id="doctorSpecialty">
                            <option value="">Select Specialty</option>
                            <!-- Populated by JS -->
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Qualification *</label>
                        <select class="form-select" id="doctorQualification" multiple style="min-height: 80px;">
                            <option value="MBBS">MBBS</option>
                            <option value="MD">MD</option>
                            <option value="MS">MS</option>
                            <option value="DNB">DNB</option>
                            <option value="BAMS">BAMS</option>
                            <option value="BHMS">BHMS</option>
                            <option value="DHMS">DHMS</option>
                            <option value="BDS">BDS</option>
                            <option value="MDS">MDS</option>
                            <option value="BPT">BPT</option>
                            <option value="MPT">MPT</option>
                            <option value="FCPS">FCPS</option>
                        </select>
                        <p style="font-size: 11px; color: var(--admin-text-muted);">Hold Ctrl to select multiple</p>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Pincode *</label>
                        <input type="text" class="form-input" id="doctorPincode" maxlength="6" pattern="\d{6}"
                            placeholder="39xxxx">
                    </div>
                    <div class="form-group full-width">
                        <label class="form-label">Area / City *</label>
                        <input type="text" class="form-input" id="doctorArea" list="areaList"
                            placeholder="Select or Type Area">
                        <datalist id="areaList"></datalist>
                    </div>
                    <div class="form-group full-width">
                        <label class="form-label">Hospital/Clinic</label>
                        <input type="text" class="form-input" id="doctorHospital" placeholder="Hospital Name">
                    </div>
                    <label class="form-label text-sm text-gray-500 mt-2">Full Address</label>
                    <textarea class="form-textarea" id="doctorAddress" placeholder="Full address"
                        style="margin-top:0;"></textarea>
                </div>

                <div class="form-group full-width">
                    <label class="form-label">Location Pin</label>
                    <div id="admin-map-picker"
                        style="height: 300px; width: 100%; border-radius: 8px; border: 1px solid var(--admin-border); z-index: 1;">
                    </div>
                    <p style="font-size: 12px; color: var(--admin-text-muted); margin-top: 6px;">
                        Click on the map or drag the marker to set accurate location.
                    </p>
                </div>
                <div class="form-group">
                    <label class="form-label">Latitude</label>
                    <input type="number" step="any" class="form-input" id="doctorLat" placeholder="21.1702">
                </div>
                <div class="form-group">
                    <label class="form-label">Longitude</label>
                    <input type="number" step="any" class="form-input" id="doctorLng" placeholder="72.8311">
                </div>
                <div class="form-group">
                    <label class="form-label">Subscription Tier</label>
                    <select class="form-select" id="doctorTier">
                        <option value="basic">Basic</option>
                        <option value="premium">Premium</option>
                        <option value="featured">Featured</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Status</label>
                    <div class="form-check" style="margin-top: 8px;">
                        <input type="checkbox" id="doctorVerified" checked>
                        <label for="doctorVerified">Verified Doctor</label>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn btn-secondary" onclick="adminPanel.closeModal()">Cancel</button>
            <button class="btn btn-primary" onclick="adminPanel.saveDoctor()">
                <i data-lucide="save" style="width: 18px; height: 18px;"></i>
                Save Doctor
            </button>
        </div>
    </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <script src="js/data.js"></script>
    <script src="js/gujarat_data.js"></script> <!-- Gujarat Data -->
    <script src="js/admin.js"></script>
</body>

</html>